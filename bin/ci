#!/usr/bin/env bash

if [ "$TRAVIS_REPO_SLUG" == "basecamp/trix" ] && [ "$TRAVIS_BRANCH" == "master" ]; then
  $(base64 --decode <<< ZXhwb3J0IFNBVUNFX1VTRVJOQU1FPWJhc2VjYW1wX3RyaXgK)
  $(base64 --decode <<< ZXhwb3J0IFNBVUNFX0FDQ0VTU19LRVk9MjY3OGE4NzMtNzJmNC00NzU2LTkzYjUtZjFhOGUyZTc3ODIxCg==)
else
  $(base64 --decode <<< ZXhwb3J0IFNBVUNFX1VTRVJOQU1FPWJhc2VjYW1wX3RyaXhfZGV2Cg==)
  $(base64 --decode <<< ZXhwb3J0IFNBVUNFX0FDQ0VTU19LRVk9NTIzODNlNTItZTM4NC00MzZjLWFkMmUtMGZmNTcyNjIyNjc5Cg==)
  export BUILD=""
fi

echo "--- Desktop"
DESKTOP="true" bin/blade ci
DESKTOP_EXIT=$?

echo "--- Mobile"
MOBILE="true" bin/blade ci
MOBILE_EXIT=$?

[ "$DESKTOP_EXIT" == 0 ] && [ "$MOBILE_EXIT" == 0 ]
